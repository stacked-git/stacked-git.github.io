<!DOCTYPE html>
<html><head>
    <title>
         Usage Example &ndash;  Stacked Git
    </title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="stylesheet" href="/css/stgit.css">
    <link rel="stylesheet" href="/css/chroma.css">
</head>
<body>
        <div><header>
  
  <a href="/">
    <img src="/stgit.svg" alt="Stacked Git logo">
  </a>
  
  <h3><a href="/">Stacked Git</a></h3>
  <nav>
    <ul>
      
      <li>
        <a href="/changelog/">
          
          Changelog
          
        </a>
      </li>
      
      <li>
        <a href="/man/">
          
          Man Pages
          
        </a>
      </li>
      
      <li>
        <a href="/guides/">
          
          Guides
          
        </a>
      </li>
      
      <li>
        <a href="/guides/tutorial/">
          
          Tutorial
          
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/">
          
          Repository
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/issues">
          
          Issue Tracker
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://github.com/stacked-git/stgit/releases">
          
          Releases
          <img src="/github.svg" alt="GitHub logo">
        </a>
      </li>
      
      <li>
        <a href="https://groups.google.com/d/forum/stgit">
          
          Forum
          <img src="/ext-link.svg" alt="external link">
        </a>
      </li>
      
    </ul>
  </nav>
</header>
<div>
  <main>
    <h1>
      <a href="/guides/usage-example/">
        Usage Example
      </a>
    </h1>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#setup">Setup</a></li>
    <li><a href="#creating-a-patch">Creating a Patch</a></li>
    <li><a href="#working-with-multiple-patches">Working with Multiple Patches</a></li>
  </ul>
</nav>
  <h2 id="setup">Setup</h2>
<p>StGit is used with regular Git repositories. Here we setup a simple Git
repository with two files:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">$ git init myrepo
$ <span class="nb">cd</span> myrepo
$ <span class="nb">echo</span> <span class="s2">&#34;Hello&#34;</span> &gt; hi.txt
$ <span class="nb">echo</span> <span class="s2">&#34;Goodbye&#34;</span> &gt; bye.txt
$ git add hi.txt bye.txt
$ git commit -m <span class="s2">&#34;Initial commit&#34;</span>
</code></pre></div><p>The <code>stg init</code> command is run once to enable use of StGit on a branch,
in this case the <code>master</code> branch.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg init
</code></pre></div><p>After initializing StGit, new patches may be created. But first, let&rsquo;s
make an edit to one of the files.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ <span class="nb">echo</span> <span class="s2">&#34;Hello world&#34;</span> &gt; hi.txt
$ stg status
 M hi.txt
</code></pre></div><p>The <code>stg status</code> command is just a built-in alias for <code>git status -s</code>.</p>
<h2 id="creating-a-patch">Creating a Patch</h2>
<p>Now that we have modified <code>hi.txt</code>, we can create a new <em>patch</em> to
capture the change. We give the patch a name, in this case
<code>hello-patch</code>.</p>
<p>StGit patches <em>are</em> regular Git commits, so they have a commit message.
The <code>-m</code> option to <code>stg new</code> is used to provide a message for the patch.
Like <code>git commit</code>, if we do not provide a message on the command line,
we will be prompted to enter a message interactively using <code>$EDITOR</code>.</p>
<p>A nice thing about StGit patches is that their commit message can easily
be revised the using <code>stg edit</code>. So for now, we use a short and simple
message.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg new -m <span class="s2">&#34;Improve greeting&#34;</span> hello-patch
Now at patch <span class="s2">&#34;hello-patch&#34;</span>
</code></pre></div><p>With the first patch created, we can take a look at the patch stack
using the <code>stg series</code> command:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg series
&gt; hello-patch
</code></pre></div><p>Creating a new patch with <code>stg new</code> does not capture modifications in
our working tree to the patch. Another step is required to incorporate
modifications from the working tree into the current (topmost) patch.
To do this, we use <code>stg refresh</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg status
 M hi.txt
$ stg refresh
Now at patch <span class="s2">&#34;hello-patch&#34;</span>
$ stg status
</code></pre></div><p>We can see the contents of a patch using <code>stg show</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg show hello-patch
</code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-diff" data-lang="diff">commit 4ce03d47953f19771ff4e1030a296c4628e43531
Author: Au Thor &lt;author@example.com&gt;
Date:   Wed Jan 1 23:59:00 2020 -0400

    Improve greeting

<span class="gh">diff --git a/hi.txt b/hi.txt
</span><span class="gh">index e965047..f75ba05 100644
</span><span class="gh"></span><span class="gd">--- a/hi.txt
</span><span class="gd"></span><span class="gi">+++ b/hi.txt
</span><span class="gi"></span><span class="gu">@@ -1 +1 @@
</span><span class="gu"></span><span class="gd">-Hello
</span><span class="gd"></span><span class="gi">+Hello world
</span></code></pre></div><h2 id="working-with-multiple-patches">Working with Multiple Patches</h2>
<p>StGit is most useful when working on more than one patch concurrently.
Let&rsquo;s add another patch to improve the goodbye.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg new -m <span class="s2">&#34;goodbye&#34;</span> goodbye-patch
Now at patch <span class="s2">&#34;goodbye-patch&#34;</span>
$ stg series
+ hello-patch
&gt; goodbye-patch
$ <span class="nb">echo</span> <span class="s2">&#34;Farewell, cruel world.&#34;</span> &gt; bye.txt
$ stg refresh
Now at patch <span class="s2">&#34;goodbye-patch&#34;</span>
</code></pre></div><p>These patches are looking good...except the greeting is missing
punctuation! With StGit, we can easily revisit an earlier patch, make
changes, and return to the prior patch using <code>stg pop</code> and <code>stg push</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg pop
Popped goodbye-patch
Now at patch <span class="s2">&#34;hello-patch&#34;</span>
$ <span class="nb">echo</span> <span class="s2">&#34;Hello, world.&#34;</span> &gt; hi.txt
$ stg refresh
Now at patch <span class="s2">&#34;hello-patch&#34;</span>
$ stg push
Pushing patch <span class="s2">&#34;goodbye-patch&#34;</span> ... <span class="k">done</span>
Now at patch <span class="s2">&#34;goodbye-patch&#34;</span>
</code></pre></div><p>We want to make sure to have quality commit messages before we call
these patches complete. Let&rsquo;s update the top patch (<code>goodbye-patch</code>)
with an improved commit message using <code>stg edit</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg edit -m <span class="s2">&#34;Use elaborate farewell&#34;</span>
</code></pre></div><p>Perfect. The last step is to commit these patches to the repository&rsquo;s
history using <code>stg commit</code>. We use the <code>--all</code> option to indicate that
we want all applied patches to be committed.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh">$ stg commit --all
</code></pre></div><p>StGit patches are regular, first-class Git commit objects. They are
visible when running <code>git log</code> and can be manipulated using regular Git
commands. Thus <code>stg commit</code> does not modify the patches (commits),
instead it is updating the StGit stack state to note that the committed
patches have graduated, and are no longer in the stack.</p>

  </main>
<footer>
  <small>&copy; 2021 Stacked Git Authors</small>
</footer>
</div>
        </div>
    </body>
</html>
